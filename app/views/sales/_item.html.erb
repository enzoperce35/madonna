<% if local_assigns.has_key? :identifier %>
  <% multi_id = ('multi' + identifier.to_s) %>
  <% prod_id = ('prod' + identifier.to_s) %>
  <% price_id = ('price' + identifier.to_s) %>
  <% total_id = ('total' + identifier.to_s) %>
  <% up_id = ('up' + identifier.to_s) %>
  <% down_id = ('down' + identifier.to_s) %>
<% end %>

<tr>
  <td style="width: 5%;">
    <%= f.input_field :_destroy, as: :hidden %>
    <%= link_to '[X]', '#', class: 'remove_record' %>
  </td>
  
  <td>
    <%= f.input :product, label: false, collection: Product.all.order(:name), input_html: {id: prod_id} %><br>
  </td>
    
  <td id= <%= price_id %> style="width: 10%" ></td>
    
  <td style="width: 3%;"><div id=<%= down_id %> class="btn btn-warning">-</div></td>
  
  <td style="width: 5%;">
    <!--<%= f.number_field :multiplier, :id => multi_id, min: 0, max: 99 %>-->
    <%= f.input(:multiplier, label: false, as: :string, components: [:input], :wrapper => false, input_html: {id: multi_id, value: f.object.multiplier || 0 } )%>
  </td>
  
  <td style="width: 3%;"><div id=<%= up_id %> class="btn btn-success">+</div></td>
  
  <td id= <%= total_id %> + suff style="text-align:right"></td>
</tr>


<script>
 
  var a = 1;
  function increase(){
    var text = document.getElementById('<%= multi_id %>');
    text.value = a;
    a++;
  }
  
  function decrease(){
    var text = document.getElementById('<%= multi_id %>');
    text.value = a;
    a--;
  }
  
  document.getElementById('<%= up_id %>').addEventListener('click', function() {
    increase()
    var queryString = Number(document.getElementById('<%= prod_id %>').value) - 1;
    var queryCount = document.getElementById('<%= multi_id %>').value;
    var total = '<%= @products %>'.slice(1, -1).split(',');
    var price = total[queryString];
    
   if (queryString > -1) {
     document.getElementById('<%= price_id %>').innerHTML = price
   };
    
     document.getElementById('<%= total_id %>').innerHTML = (price * queryCount)
  });
  
  document.getElementById('<%= down_id %>').addEventListener('click', function() {
    decrease()
    var queryString = Number(document.getElementById('<%= prod_id %>').value) - 1;
    var queryCount = document.getElementById('<%= multi_id %>').value;
    var total = '<%= @products %>'.slice(1, -1).split(',');
    var price = total[queryString];
    
   if (queryString > -1) {
     document.getElementById('<%= price_id %>').innerHTML = price
   };
    
     document.getElementById('<%= total_id %>').innerHTML = (price * queryCount)
  });
  
</script>
