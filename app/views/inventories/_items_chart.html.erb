<div class="container">
    <%= link_to 'Add Inventory Item', new_inventory_path, {:class => "btn btn-outline-secondary btn-sm"} %><br><br>
    <% @items.each_with_index do | item, index | %>
      <% raw_data = (item.remaining_stock / item.current_stock) * 100.round(2) %>
      <% data = raw_data.to_s + '%' %>
      <% index += 1 %>
      <% index = index.to_s %>
      <% id_target = 'prog-' + index.to_s %>
        
      <% if raw_data > 50 %>
        <% bg = 'bg-success' %>
      <% elsif raw_data <= 25 %>
        <% bg = 'bg-danger' %>
      <% else %>
        <% bg = 'bg-warning' %>
      <% end %>
      
      <div class="container" style="padding-left: 0%;">
        <div>
          <strong><%= link_to item.name, inventory_path(item), method: 'get' %></strong>
        </div>
        <div class="progress">
          <div id=<%= id_target %> class="progress-bar <%= bg %>" role="progressbar" aria-valuenow="41" aria-valuemin="0" aria-valuemax="100"><%= raw_data.round(2).to_s %>%</div>
        </div>
      </div>
  
      <style>
        :root {
        --data: <%= data %>;
        --index: <%= index %>;
        --item_count: <%= @items.length %>;
        }
      </style>
  
      <script>
        var css_root = document.querySelector(':root');
        var css_data = getComputedStyle(css_root);
          
        var data = css_data.getPropertyValue('--data');
        var index = css_data.getPropertyValue('--index');
        var item_count = css_data.getPropertyValue('--item_count')
  
        num_in_js_format = Number(index)
          
        data_arr.push(data)
        id_arr.push(num_in_js_format)
          
        render_data(data_arr, id_arr); if (item_count == num_in_js_format);
      </script> 
    <% end %>
  </div>
    